# ~/.bashrc â€” openSUSE

# ---- Interactive shell guard ----
case $- in
  *i*) ;;
    *) return ;;
esac

# ---- History behavior ----
HISTCONTROL=ignoreboth
shopt -s histappend
HISTSIZE=1000
HISTFILESIZE=2000

# ---- Terminal behavior ----
shopt -s checkwinsize

# ---- less enhancements (openSUSE uses lesspipe.sh) ----
[ -x /usr/bin/lesspipe.sh ] && eval "$(SHELL=/bin/sh lesspipe.sh)"

# ---- Color prompt detection ----
case "$TERM" in
  xterm-color|*-256color) color_prompt=yes ;;
esac

# ---- Prompt ----
get_ip() {
  curl -s ifconfig.me
}

PS1='\[\e[31m\][\[\e[m\]\[\e[38;5;172m\][\$(get_ip)] \[\e[38;5;214m\]\W\[\e[m\]\[\e[31m\]]\[\e[m\]\$ '

# ---- Xterm title ----
case "$TERM" in
  xterm*|rxvt*)
    PS1="\[\e]0;\u@\h: \w\a\]$PS1"
    ;;
esac

# ---- ls / grep colors ----
if [ -x /usr/bin/dircolors ]; then
  test -r ~/.dircolors && eval "$(dircolors -b ~/.dircolors)" || eval "$(dircolors -b)"
  alias ls='ls --color=auto'
  alias grep='grep --color=auto'
  alias fgrep='fgrep --color=auto'
  alias egrep='egrep --color=auto'
fi

# ---- ls shortcuts ----
alias ll='ls -alF'
alias la='ls -A'
alias l='ls -CF'

# ---- Desktop notification helper ----
alias alert='notify-send --urgency=low \
  -i "$([ $? = 0 ] && echo terminal || echo error)" \
  "$(history|tail -n1|sed -e '\''s/^\s*[0-9]\+\s*//;s/[;&|]\s*alert$//'\'')"'

# ---- Load aliases ----
if [ -f ~/.bash_aliases ]; then
  . ~/.bash_aliases
fi

# ---- Bash completion (openSUSE paths) ----
if ! shopt -oq posix; then
  if [ -f /usr/share/bash-completion/bash_completion ]; then
    . /usr/share/bash-completion/bash_completion
  fi
fi

# ---- Node / NVM ----
export NVM_DIR="$HOME/.nvm"
[ -s "$NVM_DIR/nvm.sh" ] && . "$NVM_DIR/nvm.sh"
[ -s "$NVM_DIR/bash_completion" ] && . "$NVM_DIR/bash_completion"

# ---- PATH ----
export PATH="$HOME/.local/bin:$PATH"

# =====================================================
# Explicit, deterministic numbered tools (your core)
# =====================================================

lsn() {
  ls -a1 --color=always | awk '
    BEGIN { i=1 }
    { printf "%2d: %s\n", i++, $0 }
  '
}

cdn() {
  local target
  target=$(ls -a1 | sed -n "${1}p")

  [ -n "$target" ] || { echo "No such item number: $1"; return 1; }

  if [ -d "$target" ]; then
    cd "$target"
  else
    echo "Not a directory: $target"
  fi
}

nanno() {
  local target
  target=$(ls -a1 | sed -n "${1}p")

  [ -n "$target" ] || { echo "No such item number: $1"; return 1; }

  if [ "$EUID" -eq 0 ]; then
    nano "$target"
  else
    sudo nano "$target"
  fi
}

catn() {
  local target
  target=$(ls -a1 | sed -n "${1}p")

  [ -n "$target" ] || { echo "No such item number: $1"; return 1; }

  if [ "$EUID" -eq 0 ]; then
    cat "$target"
  else
    sudo cat "$target"
  fi
}
